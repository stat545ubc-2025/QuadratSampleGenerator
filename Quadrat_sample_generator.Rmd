---
title: "Assignment_B1: Quadrat Sample Generator"
author: "Freya"
date: "2025-11-3"
output: github_document
---

As a biologist, I wanted to make my function something useful to what I do for my research. I made a function that can randomly select quadrats based on the dimensions of the given grid and number of quadrats that are supposed to be sampled. The function can then plot a rough map of the area and which quadrats have been selected to be sampled.


## Function 
```{r}
library(tidyverse) # Installing packages required for the function
library(testthat)
library(roxygen2)
library(ggplot2)

#' @title Quadrat Random Sampling Generator
#' @description Function randomly selects the desired number of quadrats to be sampled based 
#' on the given dimensions of the gridded study site, and plots a map showing 
#' these quadrats. Input should not be a vector (integer value only).
#' 
#' @param height Integer for the height of the grid in the sampling area (in quadrats).
#' @param width Integer with the width of the grid in the sampling area (in quadrats).
#' @param n_quadrats Integer with the number quadrats to be sampled. 
#' @returns A plot showing which quadrats to randomly sample in the specific grid.
#' @examples
#' quadrat_sample_generator(11, 10, 6) 
#' quadrat_sample_generator (height = 5, width = 5, n_quadrats = 3)


quadrat_sample_generator <- function(height, width, n_quadrats) {

  # Throw an error if one of the parameters entered is not an integer
      if(any(c(height, width, n_quadrats) %% 1 != 0)){ # If parameters are not divisible by 1 with remainder of 0
        stop("height, width, or n_quadrats must be an integer") # Throw this error message and stop the function
      }
  
  # Throw an error if one of the parameters entered is 0
      if(any(c(height, width, n_quadrats) == 0)){ # If parameters are 0 
        stop("height, width, or n_quadrats cannot be 0") # Throw this error message and stop the function
      }
  
  # Throw an error if one of the parameters entered is negative
      if(any(c(height, width, n_quadrats) < 0)){ # If parameters are negative 
        stop("height, width, or n_quadrats cannot be negative") # Throw this error message and stop the function
      }
  
  # Throw an error if the n_quadrats is larger than the height * width parameters
      if(n_quadrats > height * width){ # If parameters are negative 
        stop("n_quadrats cannot be greater than the total number of quadrats")
      }
  
  # Creates a grid using the dimensions given
  grid <- expand_grid(height = 1:height,
                      width = 1:width)

  # Randomly select quadrats
  samples <- sample(1:nrow(grid), n_quadrats)
  
  # Mark sampled quadrats
  grid$sample <- "Unsampled"
  grid$sample[samples] <- "Sampled"
  
  # Plot the map
  ggplot(grid, aes(x = width, y = height, fill = sample)) +
    geom_tile(color = "black") + # Outlines quadrats in black
    scale_fill_manual(values = c("Sampled" = "black", "Unsampled" = "white")) +
    scale_y_continuous(breaks = c(1:height)) + # Marks each cell given
    scale_x_continuous(breaks = c(1:width)) +
    theme_classic() 
}
```

## Examples
I will now demonstrate the use of my function below with 2 different plot specifications.

#### Example 1
Sampling site with a height of 2, width of 14, and 9 randomly sampled quadrats.
```{r}
quadrat_sample_generator(2,14,9)
```
#### Example 2
Creates a 10 x 10 grid site with one third of the quadrats being randomly sampled.
```{r}
quadrat_sample_generator(height = 10, width = 10, n_quadrats = 33) 
```

## Testthat
Now I am going to test my function to see how robust it is using the *testthat* function.

```{r}
test_that("quadrat_sample_generator throws the correct errors", {
  expect_error(quadrat_sample_generator(2.5, 10, 12)) # Check if error for non integers is recognized
  expect_error(quadrat_sample_generator(-10, 10, 25)) # Check if error for negative numbers is recognized
  expect_error(quadrat_sample_generator(1, 5, 6)) # Check if error for n_quadrats sampled is greater than height*width
})
```
  







